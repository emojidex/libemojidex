CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

PROJECT(LIBEMOJIDEX)

SET(OBJC_TARGET @OBJC_TARGET@-impl)


# TODO: Find GNUstep include directory path.
SET(GNUSTEP_INCLUDE_DIRS "/usr/include/GNUstep" "/usr/local/include/GNUstep")

INCLUDE_DIRECTORIES(@EMOJIDEX_INCLUDE_DIRS@ ${GNUSTEP_INCLUDE_DIRS})
LINK_DIRECTORIES(@PROJECT_BINARY_DIR@)

SET(OBJC_HEADER_FILES
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/client.h
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/service/search.h
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/service/indexes.h
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/data/moji_codes.h
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/data/collection.h
)

SET(OBJC_SOURCE_FILES
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/client.mm
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/service/search.mm
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/service/indexes.mm
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/data/moji_codes.mm
  @PROJECT_SOURCE_DIR@/interfaces/objective_c/src/data/collection.mm
)

SET(CMAKE_CXX_FLAGS "@CMAKE_CXX_FLAGS@ -fconstant-string-class=NSConstantString")

SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY @PROJECT_BINARY_DIR@)
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY @PROJECT_BINARY_DIR@)

ADD_LIBRARY(${OBJC_TARGET} SHARED ${OBJC_SOURCE_FILES})
TARGET_LINK_LIBRARIES(${OBJC_TARGET} "-lobjc" "-lgnustep-base" "@STATIC_LIB_NAME@" @EMOJIDEX_LINK_LIBRARIES@)

SET_TARGET_PROPERTIES(${OBJC_TARGET}
  PROPERTIES
  POSITION_INDEPENDENT_CODE TRUE
  OUTPUT_NAME @OBJC_LIB_NAME@
)
